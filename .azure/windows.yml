jobs:
- job: floskell_test_windows
  timeoutInMinutes: 120
  pool:
    vmImage: 'windows-2019'
  steps:
  - bash: |
      choco install -y --ignore-dependencies ghc --version=8.8.3 --force --allow-downgrade
      choco install -y --ignore-dependencies ghc --version=8.10.1 --force
      choco install -y --ignore-dependencies ghc --version=8.10.2
      choco install -y cabal
      $(cygpath $ProgramData)/chocolatey/bin/RefreshEnv.cmd
      export GHCS_PATH=$(cygpath $ProgramData)/chocolatey/lib/ghc/tools
      export PATH=$GHCS_PATH/ghc-8.10.2/bin:$GHCS_PATH/ghc-8.10.1/bin:$GHCS_PATH/ghc-8.8.3/bin:$PATH
      echo $PATH
      ls $GHCS_PATH
      $GHCS_PATH/ghc-8.8.3/bin/ghc-8.8.3 --version | ghc-8.10.1 --version | ghc-8.10.2 --version
      cabal update
      cabal build -w ghc-8.8.3 --ghc-options=-j | cabal build -w ghc-8.10.1 --ghc-options=-j  | cabal build -w ghc-8.10.2 --ghc-options=-j 
    displayName: 'cabal build'
